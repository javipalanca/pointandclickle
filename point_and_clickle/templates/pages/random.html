{% extends "base.html" %}
{% load resize %}

{% block content %}
    <img class="screenshot" src="{{ game.screenshots.5 | resize }}" alt="First screenshot">
    <div>
        <form action="" method="post">
            {% csrf_token %}
            <div id="remote" class="twitter-typeahead">
                <input type="text" class="form-control input-lg typeahead tt-input" name="q" placeholder=""/>
            </div>
        </form>
    </div>
{% endblock %}

{% block inline_javascript %}
    {{ block.super }}
    <script src="//code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous"></script>
    <script src="https://twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>

    <script>
        $(function () {
            let titlesDisplay = new Bloodhound({
                datumTokenizer: Bloodhound.tokenizers.obj.whitespace,
                queryTokenizer: Bloodhound.tokenizers.whitespace,
                sufficient: 1,
                limit: 100,
                remote: {
                    wildcard: '%QUERY',
                    url: "/game/game-autocomplete/?q=%QUERY",
                    //transform: response => $.map(response.results, game => ({value: game.text}))
                }
            });
            titlesDisplay.initialize();

            $('#remote .typeahead').typeahead({
                    minLength: 1,
                    highlight: true,
                    hint: true
                },
                {
                    name: 'games',
                    limit: 20,
                    source: titlesDisplay.ttAdapter(),
                    //displayKey: 'value'
                });
        });
    </script>
{% endblock %}